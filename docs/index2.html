<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Sess√µes Deliberativas ‚Äì C√¢mara dos Deputados</title>

<style>
body { font-family: Arial, sans-serif; margin: 16px; }
.evento {
  border-bottom: 1px solid #ddd;
  padding: 10px 0;
}
.evento strong { display:block; }
.info { font-size: 13px; color: #555; }
.tag {
  display:inline-block;
  font-size:12px;
  background:#e3f2fd;
  padding:2px 6px;
  border-radius:4px;
  margin-top:4px;
}
</style>
</head>
<body>

<h1>Sess√µes Deliberativas da C√¢mara</h1>
<p><em>Nessas sess√µes ocorrem as vota√ß√µes oficiais.</em></p>

<p id="status">Carregando sess√µes‚Ä¶</p>
<div id="lista"></div>

<script>
const BASE = "https://dadosabertos.camara.leg.br/api/v2";
const status = document.getElementById("status");
const lista = document.getElementById("lista");

// üîπ Per√≠odo: √∫ltimos 12 meses
const fim = new Date();
const inicio = new Date();
inicio.setFullYear(fim.getFullYear() - 1);

const dataInicio = inicio.toISOString().slice(0, 10);
const dataFim = fim.toISOString().slice(0, 10);

fetch(`${BASE}/eventos?dataInicio=${dataInicio}&dataFim=${dataFim}&ordem=DESC&ordenarPor=dataHoraInicio&itens=300`)
  .then(r => r.json())
  .then(json => {
    status.innerText = "";

    const eventos = (json.dados || []).filter(ev => {
      const texto = ((ev.titulo || "") + " " + (ev.descricao || "")).toLowerCase();
      return texto.includes("sess√£o") && texto.includes("deliberativa");
    });

    if (eventos.length === 0) {
      status.innerText = "Nenhuma sess√£o deliberativa encontrada no per√≠odo.";
      return;
    }

    eventos.forEach(ev => {
      const div = document.createElement("div");
      div.className = "evento";
      div.innerHTML = `
        <strong>${new Date(ev.dataHoraInicio).toLocaleString()}</strong>
        ${ev.titulo || "Sess√£o deliberativa"}<br>
        <span class="info">${ev.descricao || "Sess√£o com delibera√ß√£o parlamentar."}</span><br>
        <span class="tag">Sess√£o deliberativa</span>
      `;
      lista.appendChild(div);
    });
  })
  .catch(err => {
    console.error(err);
    status.innerText = "Erro ao carregar sess√µes.";
  });
</script>

</body>
</html>
