<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Perfil Parlamentar â€“ CÃ¢mara dos Deputados</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    margin: 0;
    padding: 20px;
}

h1 {
    margin-bottom: 10px;
}

select {
    padding: 8px;
    font-size: 15px;
    width: 100%;
    max-width: 400px;
}

.card {
    background: #fff;
    margin-top: 20px;
    padding: 20px;
    border-radius: 8px;
    max-width: 700px;
    box-shadow: 0 2px 6px rgba(0,0,0,.1);
}

.profile {
    display: flex;
    gap: 20px;
    align-items: flex-start;
}

.profile img {
    width: 150px;
    border-radius: 6px;
}

.label {
    font-weight: bold;
}

.source {
    margin-top: 15px;
    font-size: 14px;
}
</style>
</head>

<body>

<h1>Perfil e AtuaÃ§Ã£o Parlamentar</h1>

<label class="label">Selecione o deputado:</label><br><br>
<select id="deputados">
    <option>Carregando deputados...</option>
</select>

<div id="resultado"></div>

<script>
const API = "https://dadosabertos.camara.leg.br/api/v2";

// Carregar lista de deputados
async function carregarDeputados() {
    try {
        const res = await fetch(API + "/deputados?itens=600&ordem=ASC&ordenarPor=nome");
        const json = await res.json();

        const select = document.getElementById("deputados");
        select.innerHTML = `<option value="">Selecione o deputado</option>`;

        json.dados.forEach(dep => {
            const opt = document.createElement("option");
            opt.value = dep.id;
            opt.textContent = `${dep.nome} (${dep.siglaPartido}-${dep.siglaUF})`;
            select.appendChild(opt);
        });

    } catch (err) {
        alert("Erro ao carregar deputados.");
        console.error(err);
    }
}

// Carregar perfil do deputado
async function carregarPerfil(id) {
    if (!id) return;

    const area = document.getElementById("resultado");
    area.innerHTML = "<p>Carregando perfil...</p>";

    try {
        const res = await fetch(API + "/deputados/" + id);
        const json = await res.json();
        const d = json.dados;

        area.innerHTML = `
        <div class="card">
            <div class="profile">
                <img src="${d.ultimoStatus.urlFoto}" alt="Foto oficial">
                <div>
                    <h2>${d.nomeCivil}</h2>
                    <p><span class="label">Nome parlamentar:</span> ${d.ultimoStatus.nome}</p>
                    <p><span class="label">Partido / UF:</span> ${d.ultimoStatus.siglaPartido}-${d.ultimoStatus.siglaUF}</p>
                    <p><span class="label">Legislatura:</span> ${d.ultimoStatus.idLegislatura}</p>
                    <p><span class="label">SituaÃ§Ã£o:</span> ${d.ultimoStatus.condicaoEleitoral}</p>
                    <p><span class="label">Gabinete:</span>
                        ${d.ultimoStatus.gabinete.nome || "â€”"},
                        ${d.ultimoStatus.gabinete.predio || "â€”"},
                        Sala ${d.ultimoStatus.gabinete.sala || "â€”"}
                    </p>
                    <p><span class="label">E-mail:</span>
                        ${d.ultimoStatus.gabinete.email || "â€”"}
                    </p>
                </div>
            </div>

            <div class="source">
                ðŸ“Œ Fonte oficial:
                <a href="https://www.camara.leg.br/deputados/${d.id}" target="_blank">
                    PÃ¡gina institucional na CÃ¢mara dos Deputados
                </a>
            </div>
        </div>
        `;
    } catch (err) {
        area.innerHTML = "<p>Erro ao carregar perfil.</p>";
        console.error(err);
    }
}

document.getElementById("deputados").addEventListener("change", e => {
    carregarPerfil(e.target.value);
});

carregarDeputados();
</script>

</body>
</html>
